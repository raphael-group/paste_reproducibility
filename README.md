# Paste reproducibility
Code to reproduce the analysis and figures in the paper [Alignment and Integration of
Spatial Transcriptomics
Data](https://www.nature.com/articles/s41592-022-01459-6). The Paste
python package is located [here](https://github.com/raphael-group/paste).
Note that this repo used Paste version 1.1.4 so any newer versions of Paste
might have some issues (mostly likely related to minor utilities).

## Datasets
* All preprocessed datasets can be found on [zenodo](https://doi.org/10.5281/zenodo.6334774). 
* For convenience there is a script called
[`download_data.sh`](scripts/download_data.sh) that
will download all the relevant files to the [data](data/) directory in the
correct hierarchy.

## Main figures
* Figure 2
    * [2a](notebooks/pairwise-simulation.ipynb)
    * [2b](notebooks/center-align-simulation.ipynb)
    * [2c](notebooks/center-align-simulation-scanorama-comparison.ipynb)
* [Figure 3](notebooks/scc-analysis-pairwise-and-center.ipynb)
* [Figure 4](notebooks/scc-analysis-pairwise-and-center.ipynb)
* [Figure 5](notebooks/DLPFC_pairwise.ipynb)
* [Figure 6](notebooks/DLPFC_center.ipynb)

## Extended Data figures
* [ED Figure 1](notebooks/stahl-bc-analysis.ipynb) 
* [ED Figure 2](notebooks/pairwise-simulation.ipynb)
* [ED Figure 3](notebooks/scc-analysis-pairwise-and-center.ipynb)
* [ED Figure 4](notebooks/her2.ipynb) 
* [ED Figure 5](notebooks/DLPFC_pairwise.ipynb)
* [ED Figure 6](notebooks/DLPFC_pairwise.ipynb)
* [ED Figure 7](notebooks/compare-normalizations.ipynb) 
* [ED Figure 8](notebooks/DLPFC_center.ipynb)
* [ED Figure 9](notebooks/DLPFC_center.ipynb)

## Supplementary figures
* [Figure S2](notebooks/non-zero-count-figures.ipynb)
* [Figure S3](notebooks/sparsity-analysis.ipynb)
* [Figure S4](notebooks/stahl-bc-rotations.ipynb)
* [Figure S5](notebooks/center-align-simulation.ipynb)
* [Figure S6](notebooks/center-align-simulation-scanorama-comparison.ipynb) 
* [Figure S7](notebooks/scc-analysis-pairwise-and-center.ipynb)
* [Figure S8](notebooks/scc-analysis-pairwise-and-center.ipynb)
* [Figure S9](notebooks/scc-downsample-plots.ipynb)
* [Figure S10](notebooks/visium-scc-analysis.ipynb)
* [Figure S11](notebooks/spinal-cord-analysis.ipynb)
* [Figure S12](notebooks/spinal-cord-analysis.ipynb)
* [Figure S13](notebooks/her2.ipynb) 
* [Figure S14](notebooks/DLPFC_pairwise.ipynb) 
* [Figure S15](notebooks/DLPFC_pairwise.ipynb) 
* [Figure S16](notebooks/DLPFC_pairwise.ipynb) 
* [Figure S17](notebooks/DLPFC_pairwise.ipynb) 
* [Figure S18](notebooks/compare-alphas-inits.ipynb) 
* [Figure S19](notebooks/compare-alphas-inits.ipynb)
* [Figure S20](notebooks/compare-alphas-inits.ipynb) 
* [Figure S21](notebooks/cell-count-prior.ipynb) 
* [Figure S22](notebooks/cell-count-prior.ipynb) 
* [Figure S23](notebooks/cell-count-prior.ipynb) 
* [Figure S24](notebooks/DLPFC_center.ipynb)
* [Figure S25](notebooks/DLPFC_center.ipynb)
* [Figure S26](notebooks/DLPFC_center.ipynb)
* [Figure S27](notebooks/DLPFC_center.ipynb)
* [Figure S28](notebooks/DLPFC_center.ipynb)
* [Figure S29](notebooks/visualize-dlpfc.ipynb) 
* [Figure S30](notebooks/degs.ipynb)
